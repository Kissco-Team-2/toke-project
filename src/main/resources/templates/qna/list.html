<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>문의게시글 목록</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  <style>
    .page-wrap{max-width:1200px;margin:0 auto;padding:24px 16px}
    .table-header{background:#eef2ff;border-radius:10px;font-weight:600}
    .rowgrid{display:grid;grid-template-columns:110px 200px 1fr 150px 140px 160px;align-items:center}
    .card-row{border:1px solid #eee;border-radius:14px}
    .search-input{width:min(300px,50vw)}
    .btn-compact{padding:.38rem .65rem;font-size:.95rem;white-space:nowrap}
    main{margin-bottom:48px}
  </style>
</head>
<body class="d-flex flex-column min-vh-100">
<header><div th:replace="fragments/header :: site-header"></div></header>

<main class="page-wrap flex-grow-1">
  <h3 class="fw-bold mb-3">문의게시글 목록</h3>

  <!-- 검색바 + 문의하기 버튼 -->
  <form class="d-flex align-items-center gap-2 mb-3"
        th:action="@{/qna}" method="get">
    <select class="form-select" name="field" style="max-width:120px">
      <option value="title"   th:selected="${field=='title'}">제목</option>
      <option value="content" th:selected="${field=='content'}">내용</option>
      <option value="writer"  th:selected="${field=='writer'}">작성자</option>
      <option value="category" th:selected="${field=='category'}">문의 유형</option>
      <option value="id" th:selected="${field=='id'}">글번호</option>
    </select>

    <input class="form-control search-input" type="text" name="q"
           th:value="${keyword}" placeholder="검색어를 입력하세요">

    <button class="btn btn-success btn-compact" type="submit">검색</button>
    <a th:href="@{/qna}" class="btn btn-outline-secondary btn-compact">초기화</a>

    <div class="ms-auto">
      <a th:href="@{/qna/form}" class="btn btn-dark btn-compact">문의하기</a>
    </div>
  </form>

  <!-- 헤더 -->
  <div class="rowgrid table-header px-4 py-2 mb-2">
    <div>글번호</div><div>문의 유형</div><div>제목</div>
    <div>작성자</div><div>처리 상태</div><div>작성 날짜</div>
  </div>

  <div th:if="${#lists.isEmpty(page?.content)}" class="text-secondary mt-3">글이 없습니다.</div>

  <!-- 리스트 -->
  <div th:each="row : ${page.content}" class="card card-row mb-2">
    <div class="card-body rowgrid px-4 py-3">
      <div th:text="${row.id}">1</div>
      <div th:text="${row.categoryLabel}">단어 / 표현 추가</div>
      <div>
        <a th:href="@{/qna/{id}(id=${row.id})}"
           th:text="${row.title}" class="text-decoration-none fw-semibold"></a>
        <span class="badge bg-secondary ms-2" th:if="${row.isSecret == 'Y'}">비밀글</span>
      </div>
      <div th:text="${row.authorDisplay}">writer</div>
      <div>
        <span class="badge bg-warning text-dark" th:if="${row.status == 'OPEN'}">확인전</span>
        <span class="badge bg-primary" th:if="${row.status == 'ANSWERED'}">답변 완료</span>
        <span class="badge bg-secondary" th:if="${row.status == 'CLOSED'}">종료</span>
      </div>
      <div th:text="${row.createdAt != null ? #temporals.format(row.createdAt,'yyyy-MM-dd') : ''}">2025-09-05</div>
    </div>
  </div>

  <!-- 페이지네이션 -->
  <nav th:if="${page != null and page.totalPages > 1}">
    <ul class="pagination justify-content-center mt-3">
      <li class="page-item" th:classappend="${page.first} ? 'disabled'">
        <a class="page-link"
           th:href="@{/qna(field=${field}, q=${keyword}, page=${page.number-1})}">이전</a>
      </li>

      <li class="page-item"
          th:each="p : ${#numbers.sequence(0, page.totalPages-1)}"
          th:classappend="${p==page.number} ? 'active'">
        <a class="page-link"
           th:text="${p+1}"
           th:href="@{/qna(field=${field}, q=${keyword}, page=${p})}">1</a>
      </li>

      <li class="page-item" th:classappend="${page.last} ? 'disabled'">
        <a class="page-link"
           th:href="@{/qna(field=${field}, q=${keyword}, page=${page.number+1})}">다음</a>
      </li>
    </ul>
  </nav>
</main>

<footer class="mt-auto"><div th:insert="fragments/footer :: site-footer"></div></footer>
</body>
</html>
