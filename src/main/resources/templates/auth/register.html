<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>회원가입</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="/css/style.css">

<style>
body {
	background: #f7f7f7;
}
.card-soft {
	border: 0;
	border-radius: 12px;
	background: #fff;
	box-shadow: 0 10px 24px rgba(0, 0, 0, .06);
}
.card-body {
	padding: 48px 40px;
}
.form-label {
	font-weight: 600;
	color: #333;
}
.req::after {
	content: " *";
	color: #ff5a5a;
}
.form-control {
	border-radius: 8px;
}
.btn-soft-green {
	background: #caf7cf;
	color: #000;
	border: 0;
	font-weight: 600;
}
.btn-soft-green:hover {
	background: #bfe3ce;
	color: #0f5132;
}
.btn-black {
	background: #000;
	color: #fff;
	border: 0;
	font-weight: 600;
}
.btn-black:hover {
	background: #111;
	color: #fff;
}
.form-control::placeholder {
	color: #dddddd;
	opacity: 1;
	font-size: 0.8rem;
}
.text-danger {
	font-size: 0.8rem;
}
</style>
</head>
<body class="d-flex flex-column min-vh-100">
	<header th:replace="fragments/header :: site-header"></header>

	<main class="flex-grow-1">
		<div class="container p-5">
			<div class="row justify-content-center">
				<div class="card card-soft" style="width: 720px; padding: 24px;">
					<div class="card-body">
						<h2 class="text-center fw-bold">회원가입</h2>
						<div style="padding: 20px;">
							<p class="mb-4 text-muted" style="font-size: 0.8rem;">회원 정보를 입력해 주세요</p>

							<!-- th:object 추가 -->
							<form class="mt-3" th:action="@{/register}" th:object="${form}" method="post">

								<!-- 이름 -->
								<div class="row mb-4 align-items-center">
									<label for="name" class="col-sm-3 col-form-label req">이름</label>
									<div class="col-sm-9">
										<input type="text" id="name" th:field="*{username}" class="form-control" placeholder="이름 입력">
										<div class="text-danger" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></div>
									</div>
								</div>

								<!-- 이메일 -->
								<div class="row mb-4 align-items-center">
									<label for="email" class="col-sm-3 col-form-label req">이메일</label>
									<div class="col-sm-9 d-flex align-items-center gap-2">
										<input type="hidden" id="email" th:field="*{email}">
										<input type="text" id="emailId" class="form-control w-50" placeholder="example">
										<span class="text-muted">@</span>
										<select id="emailDomain" class="form-select w-50">
											<option value="naver.com" selected>naver.com</option>
											<option value="gmail.com">gmail.com</option>
											<option value="hanmail.net">hanmail.net</option>
											<option value="kakao.com">kakao.com</option>
											<option value="custom">직접 입력</option>
										</select>
										<input type="text" id="customDomain" class="form-control w-50 d-none" placeholder="직접 입력">
									</div>
									<div class="offset-sm-3 col-sm-9">
										<div class="text-danger" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
									</div>
								</div>

								<!-- 전화번호 -->
								<div class="row mb-4 align-items-center">
									<label for="phoneNumber" class="col-sm-3 col-form-label req">전화번호</label>
									<div class="col-sm-9">
										<input type="text" id="phoneNumber" th:field="*{phoneNumber}" class="form-control" placeholder="전화번호 입력 (숫자 11자리)">
										<div class="text-danger" th:if="${#fields.hasErrors('phoneNumber')}" th:errors="*{phoneNumber}"></div>
									</div>
								</div>

								<!-- 비밀번호 -->
								<div class="row mb-4 align-items-center">
									<label for="password" class="col-sm-3 col-form-label req">비밀번호</label>
									<div class="col-sm-9">
										<input type="password" id="password" th:field="*{password}" class="form-control" placeholder="영문+숫자 조합 10자 이상">
										<div class="text-danger" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
									</div>
								</div>

								<!-- 비밀번호 확인 -->
								<div class="row mb-4 align-items-center">
									<label for="confirmPassword" class="col-sm-3 col-form-label req">비밀번호 확인</label>
									<div class="col-sm-9">
										<input type="password" id="confirmPassword" th:field="*{confirmPassword}" class="form-control" placeholder="비밀번호 재입력">
										<div class="text-danger" th:if="${#fields.hasErrors('confirmPassword')}" th:errors="*{confirmPassword}"></div>
									</div>
								</div>

								<!-- 별명 -->
								<div class="row mb-4 align-items-center">
									<label for="nickname" class="col-sm-3 col-form-label req">별명</label>
									<div class="col-sm-9">
										<input type="text" id="nickname" th:field="*{nickname}" class="form-control" placeholder="별명 입력 (6자 이내)">
										<div class="text-danger" th:if="${#fields.hasErrors('nickname')}" th:errors="*{nickname}"></div>
									</div>
								</div>

								<!-- 버튼 -->
								<div class="row g-3" style="margin-top: 1.8rem;">
									<div class="col-12 col-md-6 d-grid">
										<button type="submit" class="btn btn-soft-green py-2">회원가입</button>
									</div>
									<div class="col-12 col-md-6 d-grid">
										<a th:href="@{/}" class="btn btn-black py-2">취소</a>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<footer th:replace="fragments/footer :: site-footer"></footer>

	<script>
		// 이메일 합성 JS
		const emailId = document.getElementById("emailId");
		const emailDomain = document.getElementById("emailDomain");
		const customDomain = document.getElementById("customDomain");
		const email = document.getElementById("email");

		function updateEmail() {
			let domain = emailDomain.value;
			if (domain === "custom") {
				domain = customDomain.value;
			}
			if (emailId.value && domain) {
				email.value = emailId.value + "@" + domain;
			} else {
				email.value = "";
			}
		}

		emailId.addEventListener("input", updateEmail);
		emailDomain.addEventListener("change", () => {
			if (emailDomain.value === "custom") {
				emailDomain.classList.add("d-none");
				customDomain.classList.remove("d-none");
				customDomain.focus();
			}
			updateEmail();
		});
		customDomain.addEventListener("input", updateEmail);
		customDomain.addEventListener("blur", function () {
			if (this.value === "") {
				customDomain.classList.add("d-none");
				emailDomain.classList.remove("d-none");
				emailDomain.value = "";
			}
			updateEmail();
		});
	</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
